<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>VideoHub</title>
<style>
  body {
    background-color: #121212;
    color: #eee;
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
  }
  header {
    background-color: #222;
    padding: 1rem;
    text-align: center;
    font-size: 2rem;
    font-weight: bold;
  }
  #tabs {
    display: flex;
    background-color: #1f1f1f;
  }
  #tabs button {
    flex: 1;
    padding: 1rem;
    background: none;
    border: none;
    color: #bbb;
    cursor: pointer;
    font-weight: 600;
  }
  #tabs button.active {
    color: #4caf50;
    border-bottom: 3px solid #4caf50;
    background-color: #2a2a2a;
  }
  #search-container {
    padding: 1rem;
    text-align: center;
  }
  #search-input {
    width: 90%;
    max-width: 400px;
    padding: 0.5rem 1rem;
    font-size: 1rem;
    border-radius: 5px;
    border: none;
  }
  #videos {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1rem;
    padding: 1rem;
  }
  .video-card {
    background-color: #1f1f1f;
    border-radius: 6px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    cursor: pointer;
    transition: transform 0.2s ease;
  }
  .video-card:hover {
    transform: scale(1.05);
  }
  .thumbnail {
    width: 100%;
    aspect-ratio: 16 / 9;
    object-fit: cover;
  }
  .video-info {
    padding: 0.5rem 1rem;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
  .video-title {
    font-size: 1rem;
    font-weight: 600;
    margin: 0 0 0.5rem 0;
    color: #ddd;
  }
  .video-buttons {
    display: flex;
    gap: 0.5rem;
  }
  .video-buttons button {
    flex: 1;
    background-color: #333;
    border: none;
    color: #bbb;
    padding: 0.4rem;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 600;
    transition: background-color 0.2s ease;
  }
  .video-buttons button:hover {
    background-color: #4caf50;
    color: white;
  }
  .video-buttons button.liked {
    background-color: #4caf50;
    color: white;
  }
  .video-buttons button.favorited {
    background-color: #ff9800;
    color: white;
  }
  /* Player container */
  #player-section {
    background-color: #1f1f1f;
    padding: 1rem;
    display: none;
    flex-direction: column;
  }
  #player-title {
    font-size: 1.5rem;
    margin-bottom: 1rem;
  }
  #player-video {
    width: 100%;
    max-width: 800px;
    aspect-ratio: 16 / 9;
    margin: 0 auto 1rem;
  }
  /* Player buttons */
  #player-buttons {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 1rem;
  }
  #player-buttons button {
    background-color: #333;
    border: none;
    color: #bbb;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 600;
    transition: background-color 0.2s ease;
  }
  #player-buttons button:hover {
    background-color: #4caf50;
    color: white;
  }
  /* Comments section */
  #comments-section {
    max-width: 800px;
    margin: 0 auto 2rem;
    background-color: #2a2a2a;
    border-radius: 6px;
    padding: 1rem;
    color: #ccc;
  }
  #comments-title {
    font-size: 1.2rem;
    margin-bottom: 0.8rem;
    border-bottom: 1px solid #444;
    padding-bottom: 0.3rem;
  }
  .comment {
    margin-bottom: 0.8rem;
    border-bottom: 1px solid #444;
    padding-bottom: 0.5rem;
  }
  .comment-username {
    font-weight: 700;
    color: #4caf50;
    margin-bottom: 0.2rem;
  }
  .comment-text {
    font-style: italic;
  }
  #comment-form {
    display: flex;
    gap: 0.5rem;
    margin-top: 1rem;
  }
  #comment-input {
    flex-grow: 1;
    padding: 0.5rem;
    border-radius: 4px;
    border: none;
    font-size: 1rem;
  }
  #comment-submit {
    background-color: #4caf50;
    color: white;
    border: none;
    padding: 0 1rem;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 600;
  }
  #comment-submit:hover {
    background-color: #45a045;
  }
</style>
</head>
<body>
<header>VideoHub</header>

<div id="tabs">
  <button class="tab-button active" data-tab="all">All Videos</button>
  <button class="tab-button" data-tab="favorites">Favorites</button>
  <button class="tab-button" data-tab="liked">Liked</button>
</div>

<div id="search-container">
  <input id="search-input" type="text" placeholder="Search videos..." />
</div>

<div id="videos"></div>

<div id="player-section">
  <div id="player-title"></div>
  <iframe id="player-video" src="" frameborder="0" allowfullscreen></iframe>
  <div id="player-buttons">
    <button id="player-like">Like</button>
    <button id="player-favorite">Add to Favorites</button>
    <button id="player-share">Share</button>
    <button id="player-close">Close</button>
  </div>

  <div id="comments-section">
    <div id="comments-title">Comments</div>
    <div id="comments-list"></div>
    <form id="comment-form">
      <input type="text" id="comment-input" placeholder="Add a comment..." required />
      <button type="submit" id="comment-submit">Post</button>
    </form>
  </div>
</div>

<script>
  // Your original video list - same titles, ids, thumbnails as before
  const videos = [
    {
      id: 'dQw4w9WgXcQ',
      title: 'Rick Astley - Never Gonna Give You Up (Video)',
      thumbnail: 'https://img.youtube.com/vi/dQw4w9WgXcQ/hqdefault.jpg'
    },
    {
      id: '3JZ_D3ELwOQ',
      title: 'a-ha - Take On Me (Official Video)',
      thumbnail: 'https://img.youtube.com/vi/3JZ_D3ELwOQ/hqdefault.jpg'
    },
    {
      id: '9bZkp7q19f0',
      title: 'PSY - GANGNAM STYLE(강남스타일) M/V',
      thumbnail: 'https://img.youtube.com/vi/9bZkp7q19f0/hqdefault.jpg'
    }
    // Add all other original videos here, same format
  ];

  // Reddit-style random usernames (examples)
  const usernames = [
    "QuietStorm42", "PixelPenguin", "CoffeeBean88", "MidnightCoder", "NebulaNomad",
    "RustyRocket", "EchoChaser", "SilentGuitar", "FuzzyLogic", "CrazyCatLady",
    "LazyLion", "WittyKitty", "NerdyBirdy", "SassySasquatch", "PhantomCoder",
    "CosmicTaco", "JollyJellyfish", "CyberSamurai", "FunkyFennec", "NoodleNinja"
  ];

  // LocalStorage keys
  const LIKED_VIDEOS_KEY = 'videoHub_likedVideos';
  const FAVORITES_KEY = 'videoHub_favorites';
  const COMMENTS_KEY = 'videoHub_comments';

  // State
  let currentTab = 'all';
  let currentVideoId = null;

  // Load data from localStorage or initialize empty objects
  const likedVideos = JSON.parse(localStorage.getItem(LIKED_VIDEOS_KEY)) || {};
  const favorites = JSON.parse(localStorage.getItem(FAVORITES_KEY)) || {};
  const comments = JSON.parse(localStorage.getItem(COMMENTS_KEY)) || {}; // key = videoId, value = array of comments

  // Utility: Save all to localStorage
  function saveAll() {
    localStorage.setItem(LIKED_VIDEOS_KEY, JSON.stringify(likedVideos));
    localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));
    localStorage.setItem(COMMENTS_KEY, JSON.stringify(comments));
  }

  // Render the list of videos based on current tab and search
  function renderVideos() {
    const container = document.getElementById('videos');
    container.innerHTML = '';

    // Get search query
    const searchQuery = document.getElementById('search-input').value.toLowerCase();

    // Filter videos according to tab and search
    let filteredVideos = videos.filter(video => video.title.toLowerCase().includes(searchQuery));
    if (currentTab === 'favorites') {
      filteredVideos = filteredVideos.filter(video => favorites[video.id]);
    } else if (currentTab === 'liked') {
      filteredVideos = filteredVideos.filter(video => likedVideos[video.id]);
    }

    if(filteredVideos.length === 0){
      container.innerHTML = `<p style="grid-column:1/-1; text-align:center; color:#666;">No videos found.</p>`;
      return;
    }

    filteredVideos.forEach(video => {
      const card = document.createElement('div');
      card.className = 'video-card';

      card.innerHTML = `
        <img class="thumbnail" src="${video.thumbnail}" alt="${video.title}" />
        <div class="video-info">
          <div class="video-title">${video.title}</div>
          <div class="video-buttons">
            <button class="like-btn ${likedVideos[video.id] ? 'liked' : ''}" data-id="${video.id}">Like</button>
            <button class="favorite-btn ${favorites[video.id] ? 'favorited' : ''}" data-id="${video.id}">Favorite</button>
            <button class="share-btn" data-id="${video.id}">Share</button>
          </div>
        </div>
      `;

      // Click on card opens player
      card.querySelector('.thumbnail').addEventListener('click', () => openPlayer(video.id));
      card.querySelector('.video-title').addEventListener('click', () => openPlayer(video.id));

      // Like button
      card.querySelector('.like-btn').addEventListener('click', (e) => {
        e.stopPropagation();
        toggleLike(video.id);
      });
      // Favorite button
      card.querySelector('.favorite-btn').addEventListener('click', (e) => {
        e.stopPropagation();
        toggleFavorite(video.id);
      });
      // Share button
      card.querySelector('.share-btn').addEventListener('click', (e) => {
        e.stopPropagation();
        shareVideo(video.id);
      });

      container.appendChild(card);
    });
  }

  // Toggle like status
  function toggleLike(videoId) {
    if (likedVideos[videoId]) {
      delete likedVideos[videoId];
    } else {
      likedVideos[videoId] = true;
    }
    saveAll();
    renderVideos();
    // If player open, update button states
    if(currentVideoId === videoId) updatePlayerButtons();
  }

  // Toggle favorite status
  function toggleFavorite(videoId) {
    if (favorites[videoId]) {
      delete favorites[videoId];
    } else {
      favorites[videoId] = true;
    }
    saveAll();
    renderVideos();
    if(currentVideoId === videoId) updatePlayerButtons();
  }

  // Share video (open new tab with video url)
  function shareVideo(videoId) {
    const url = `https://videos-plataform.vercel.app/?video=${videoId}`;
    if (navigator.share) {
      navigator.share({
        title: 'Check out this video on VideoHub',
        url: url
      }).catch(console.error);
    } else {
      // fallback: copy to clipboard and alert
      navigator.clipboard.writeText(url).then(() => {
        alert('Video link copied to clipboard:\n' + url);
      }).catch(() => {
        prompt('Copy this link:', url);
      });
    }
  }

  // Open video player
  function openPlayer(videoId) {
    currentVideoId = videoId;
    const video = videos.find(v => v.id === videoId);
    if (!video) return;

    const playerSection = document.getElementById('player-section');
    const playerTitle = document.getElementById('player-title');
    const playerVideo = document.getElementById('player-video');

    playerTitle.textContent = video.title;
    playerVideo.src = `https://www.youtube.com/embed/${video.id}?autoplay=1&rel=0`;

    playerSection.style.display = 'flex';
    scrollTo({top: playerSection.offsetTop, behavior: 'smooth'});
    updatePlayerButtons();
    renderComments(videoId);
  }

  // Close video player
  function closePlayer() {
    const playerVideo = document.getElementById('player-video');
    playerVideo.src = '';
    document.getElementById('player-section').style.display = 'none';
    currentVideoId = null;
  }

  // Update Like and Favorite button states in player
  function updatePlayerButtons() {
    const playerLike = document.getElementById('player-like');
    const playerFavorite = document.getElementById('player-favorite');

    if (!currentVideoId) return;

    playerLike.textContent = likedVideos[currentVideoId] ? 'Liked' : 'Like';
    playerFavorite.textContent = favorites[currentVideoId] ? 'Favorited' : 'Add to Favorites';
    
    if(likedVideos[currentVideoId]){
      playerLike.style.backgroundColor = '#4caf50';
      playerLike.style.color = 'white';
    } else {
      playerLike.style.backgroundColor = '#333';
      playerLike.style.color = '#bbb';
    }
    if(favorites[currentVideoId]){
      playerFavorite.style.backgroundColor = '#ff9800';
      playerFavorite.style.color = 'white';
    } else {
      playerFavorite.style.backgroundColor = '#333';
      playerFavorite.style.color = '#bbb';
    }
  }

  // Render comments for video
  function renderComments(videoId) {
    const commentsList = document.getElementById('comments-list');
    commentsList.innerHTML = '';

    if (!comments[videoId]) {
      comments[videoId] = [];
    }

    if (comments[videoId].length === 0) {
      commentsList.innerHTML = '<p>No comments yet. Be the first!</p>';
      return;
    }

    comments[videoId].forEach(comment => {
      const commentDiv = document.createElement('div');
      commentDiv.className = 'comment';

      commentDiv.innerHTML = `
        <div class="comment-username">${comment.username}</div>
        <div class="comment-text">${comment.text}</div>
      `;
      commentsList.appendChild(commentDiv);
    });
  }

  // Generate random username from list
  function getRandomUsername() {
    return usernames[Math.floor(Math.random() * usernames.length)];
  }

  // Handle comment submission
  document.getElementById('comment-form').addEventListener('submit', (e) => {
    e.preventDefault();
    const input = document.getElementById('comment-input');
    const text = input.value.trim();
    if (!text || !currentVideoId) return;

    const username = getRandomUsername();
    if (!comments[currentVideoId]) comments[currentVideoId] = [];
    comments[currentVideoId].push({ username, text });

    saveAll();
    input.value = '';
    renderComments(currentVideoId);
  });

  // Player buttons events
  document.getElementById('player-like').addEventListener('click', () => {
    if(currentVideoId) toggleLike(currentVideoId);
  });
  document.getElementById('player-favorite').addEventListener('click', () => {
    if(currentVideoId) toggleFavorite(currentVideoId);
  });
  document.getElementById('player-share').addEventListener('click', () => {
    if(currentVideoId) shareVideo(currentVideoId);
  });
  document.getElementById('player-close').addEventListener('click', () => {
    closePlayer();
  });

  // Tabs events
  document.querySelectorAll('#tabs button').forEach(button => {
    button.addEventListener('click', () => {
      document.querySelectorAll('#tabs button').forEach(b => b.classList.remove('active'));
      button.classList.add('active');
      currentTab = button.dataset.tab;
      renderVideos();
      closePlayer();
    });
  });

  // Search input event
  document.getElementById('search-input').addEventListener('input', () => {
    renderVideos();
    closePlayer();
  });

  // Initial render
  renderVideos();
</script>
</body>
</html>
